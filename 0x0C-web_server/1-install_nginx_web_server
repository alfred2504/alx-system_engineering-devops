#!/usr/bin/env bash

# Update package lists and install Nginx
sudo apt-get update
sudo apt-get install -y nginx

# Create a temporary HTML file with Hello World content
echo "<html><body>Hello World!</body></html>" | sudo tee /var/www/html/index.html

# Check if Nginx is already running and stop it
if sudo service nginx status | grep -q "active (running)"; then
    sudo service nginx stop
fi

# Start Nginx and ensure it listens on port 80
sudo nginx -t && sudo nginx -g 'daemon off;'

# Test Nginx by querying it with curl
if curl -s http://localhost:80/ | grep -q "Hello World!"; then
    echo "Nginx installed and configured successfully!"
else
    echo "Error: Nginx configuration failed."
fi
